---
import "../assets/css/tab.css";
import Icon from "../assets/images/tab-link-icon.svg";
import LinkButton from "./LinkButton.astro";
import LiIcon from "../assets/images/li-icon.png"
const projects = [
    {
        title: "Consulting Services",
        paragraph: "Giriraj Digital offers specialized consulting services. Our experts provide strategic guidance, helping businesses align their AI initiatives with overall objectives. From refining existing strategies to charting a new AI course, our consultants are here to guide you every step of the way.",
        List: ["Tailored consulting to align your AI initiatives with business objectives.",
            "Refining and shaping your AI strategy for maximum impact.",
            "Tapping into our team's deep knowledge to navigate the complexities."
        ],
    },
    {
        title: "Helpdesk Management System",
        paragraph: "Dive into the world of AI innovation with Giriraj Digital's AI product engineering services. We specialize in crafting robust and scalable AI products tailored to your unique business needs. From conceptualization to deployment, our engineering team ensures your AI product stands out in the market.",
        List: ["Crafting scalable and robust AI products to meet unique business needs.",
            "Bringing cutting-edge AI capabilities to the heart of your product engineering.",
            "Ensuring your AI product stands out in a competitive market"
        ],
    },
    {
        title: "AI Web App Development",
        paragraph: "Elevate your online presence with Giriraj Digital's AI web app development. We bring AI capabilities to the web, creating interactive and intelligent applications that enhance user experiences. Our development team combines expertise in AI technologies with modern web development to deliver cutting-edge solutions.",
        List: ["Intelligent Applications: Developing AI-infused web applications for enhanced user experiences.",
            "Tech Fusion: Integrating AI technologies seamlessly into modern web development practices.",
            "Interactive Solutions: Creating web applications that are not just functional but also intelligent and interactive."
        ],
    },
    {
        title: "QA Testing",
        paragraph: "Ensure the reliability and performance of your AI solutions with Giriraj Digital's quality assurance (QA) testing services. Our dedicated QA team rigorously tests every aspect of your AI applications, identifying and addressing potential issues to guarantee a seamless and error-free user experience.",
        List: ["Thorough quality assurance testing to ensure reliability and performance.",
            "Identifying and addressing potential issues before they impact users.",
            "Guaranteeing a smooth and error-free experience for users."
        ],
    },
    {
        title: "Maintenance & Support",
        paragraph: "Giriraj Digital doesn't just deliver solutions; we ensure they stay optimal. Our maintenance and support services provide ongoing assistance, addressing any issues, implementing updates, and ensuring the continued success of your AI applications. Trust us to keep your AI systems running smoothly.",
        List: ["Providing continuous support to address any issues post-implementation.",
            "Implementing updates and enhancements to keep your AI systems optimized.",
            "Ensuring the long-term success and efficiency of your AI applications through reliable maintenance and support."
        ],
    },
    {
        title: "Dedicated Development Services",
        paragraph: "Our dedicated development services include comprehensive AI automation services. From initial consultation and strategic planning to deployment and continuous support, Giriraj Digital is your comprehensive dedicated development partner. It ensures a holistic approach, covering every aspect of your AI project with dedicated attention and expertise.",
        List: ["Comprehensive AI services from consultation to deployment.",
            "Collaborative planning for a strategic and effective AI journey.",
            "Unwavering support throughout your AI project, ensuring success at every stage."
        ],
    }
];

---

<section id="services-tabs-section" class="section-container w-full bg-white grid grid-cols-12 gap-5 lg:gap-[30px] ">
    <div class="col-span-12 lg:col-start-2 lg:col-span-10 rounded-2xl lg:rounded-[30px] 
            bg-[#E9F2FC] grid grid-cols-1 lg:grid-cols-10 gap-5 lg:gap-[30px] xl:gap-[60px]
            py-5 px-5 lg:pb-0 lg:pt-10 lg:px-10 xl:pt-[70px] xl:px-[70px]">

        <!-- Header -->
        <div class="space-y-2 lg:space-y-5 col-span-10">
            <p class="text-[#0FA1DB] font-semibold lg:text-xl">The services we offer!</p>

            <div class="flex flex-col space-y-3.5 lg:space-y-0 lg:flex-row">
                <h2 class="text-[#212529] text-[26px] lg:text-4xl xl:text-5xl leading-[120%] font-bold">
                    Dig down on the range of customized services we offer to AI automation consulting company
                </h2>
        
            </div>
        </div>

        <!-- Tabs -->
        <div class="col-span-10 lg:col-span-3 space-y-6 lg:space-y-8 lg:pb-8">
            {projects.map((project, index) => (
                <div
                    class="services-tabs-item"
                    data-index={index}
                    data-paragraph={project.paragraph}
                    data-list={JSON.stringify(project.List)}
                    >

                <div class="space-y-5 lg:space-y-[26px] cursor-pointer">
                        <div class="flex space-x-2.5 items-center">
                            <p class="text-[#21292C] font-bold lg:text-xl">
                                {project.title}
                            </p>
                            <img src={Icon.src} alt="tab-link-icon" class="tab-link-icon w-5 h-5" />
                        </div>

                        <div class="tabs-progress mt-4 hidden lg:block">
                        <div class="progress-bg"></div>
                        <div class="progress-fill"></div>
                    </div>

                    <div class="mobile-content lg:hidden! bg-white p-5 rounded-lg outline-8 outline-white space-y-6 w-full">
                        <p class="mobile-paragraph text-[#2C363A]"></p>
                        <div class="mobile-list space-y-3"></div>
                    </div>


                    <div class="tabs-progress mt-7 lg:hidden">
                        <div class="progress-bg"></div>
                        <div class="progress-fill"></div>
                    </div>
                </div>
                </div>
            ))}
            </div>


        <div class="col-span-10 lg:col-span-7 hidden lg:flex bg-[url('../assets/images/tab-bg.webp')] rounded-t-[30px] pt-[30px] px-[30px] lg:pt-[60px] lg:px-[60px] items-end justify-center">

            <div class="bg-white h-full p-5 xl:p-10 rounded-[20px] rounded-b-none outline-8 outline-white space-y-6 w-full">

                <!-- PARAGRAPH -->
                <p id="tab-paragraph" class="text-[#2C363A] lg:text-lg"></p>

                <!-- LIST -->
                <ul id="tab-list" class="space-y-3 text-[#21292C] font-medium leading-7 list-none"></ul>

            </div>
        </div>

        
    </div>
</section>


<style>
    /* Base tab item */
    .services-tabs-item {
    position: relative;
    transition: all 0.3s ease;
    }

    /* Always-visible indicator (small) */
    .services-tabs-item[data-astro-cid-dbisoard]::before {
    content: "";
    position: absolute;
    left: -14px;
    top: 18px;
    width: 8px;
    height: 8px;
    background: #cbd5e1; /* gray */
    border-radius: 50%;
    transition: all 0.3s ease;
    }

    /* Active tab */
    .services-tabs-item.active {
    opacity: 1;
    }

    /* Active indicator */
    .services-tabs-item.active[data-astro-cid-dbisoard]::before {
    width: 14px;
    height: 14px;
    left: -17px !important;
    background: #0FA1DB;
    }

</style>

<script is:inline>
const tabs = document.querySelectorAll(".services-tabs-item");
const tabParagraph = document.getElementById("tab-paragraph");
const tabList = document.getElementById("tab-list");

let currentIndex = 0;
const intervalTime = 7000;
let autoplayTimeout = null;

let isDesktop = window.innerWidth >= 1024;

/* ---------------- HELPERS ---------------- */

function getVisibleFills(tab) {
    return Array.from(tab.querySelectorAll(".progress-fill"))
        .filter(fill => fill.offsetParent !== null);
}

function resetTab(tab) {
    tab.classList.remove("active");
    tab.classList.add("opacity-70");

    getVisibleFills(tab).forEach(f => {
        f.style.transition = "none";
        f.style.width = "0%";
    });
}

/* ---------------- CONTENT ---------------- */

function updateRightContent(tab) {
    if (tabParagraph && tabList) {
        tabParagraph.textContent = tab.dataset.paragraph || "";
        tabList.innerHTML = "";
    }

    const list = tab.dataset.list ? JSON.parse(tab.dataset.list) : [];

    list.forEach(text => {
        const row = document.createElement("li");
        row.className = "list-none relative pl-8 before:content-[''] before:absolute before:left-0 before:top-3.5 before:-translate-y-1/2 before:w-6 before:h-6 before:bg-[url('/li-icon.png')] before:bg-no-repeat before:bg-contain lg:text-lg";
        row.innerHTML = `${text}
    `;


        if (tabList) tabList.appendChild(row.cloneNode(true));

        const mobileList = tab.querySelector(".mobile-list");
        if (mobileList) mobileList.appendChild(row);
    });

    const mobilePara = tab.querySelector(".mobile-paragraph");
    if (mobilePara) mobilePara.textContent = tab.dataset.paragraph || "";
}

/* ---------------- AUTOPLAY ---------------- */

function scheduleNext() {
    clearTimeout(autoplayTimeout);

    //  No autoplay on mobile
    if (!isDesktop) return;

    autoplayTimeout = setTimeout(nextTab, intervalTime);
}

function animateProgress(tab) {
    getVisibleFills(tab).forEach(f => {
        f.style.transition = "none";
        f.style.width = "0%";

        requestAnimationFrame(() => {
            requestAnimationFrame(() => {
                f.style.transition = `width ${intervalTime}ms linear`;
                f.style.width = "100%";
            });
        });
    });
}

/* ---------------- CORE ---------------- */

function activateTab(index) {
    currentIndex = index;

    tabs.forEach(resetTab);

    const activeTab = tabs[currentIndex];
    activeTab.classList.add("active");
    activeTab.classList.remove("opacity-70");

    updateRightContent(activeTab);
    animateProgress(activeTab);
    scheduleNext();
}

function nextTab() {
    activateTab((currentIndex + 1) % tabs.length);
}

/* ---------------- EVENTS ---------------- */

tabs.forEach((tab, index) => {
    tab.addEventListener("click", () => {
        clearTimeout(autoplayTimeout);
        activateTab(index);
    });
});

window.addEventListener("resize", () => {
    const nowDesktop = window.innerWidth >= 1024;

    if (nowDesktop !== isDesktop) {
        isDesktop = nowDesktop;
        clearTimeout(autoplayTimeout);
        scheduleNext();
    }
});

/* ---------------- INIT ---------------- */

activateTab(0);


let hasStarted = false;

const section = document.getElementById("services-tabs-section");

const observer = new IntersectionObserver(
  ([entry]) => {
    if (entry.isIntersecting && !hasStarted) {
      hasStarted = true;
      activateTab(0); // start autoplay only once
    }
  },
  {
    threshold: 0.3, // 30% visible
  }
);

observer.observe(section);


</script>



